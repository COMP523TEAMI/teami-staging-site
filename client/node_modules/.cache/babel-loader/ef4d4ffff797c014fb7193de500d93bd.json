{"ast":null,"code":"import _regeneratorRuntime from\"/Users/linqiaosen/Desktop/domo/staging-demo-i/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/linqiaosen/Desktop/domo/staging-demo-i/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/linqiaosen/Desktop/domo/staging-demo-i/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useContext}from\"react\";import UserContext from\"../../context/UserContext\";import styles from\"../Template/PageTemplate.module.css\";import{Typography,IconButton,Box,Button,TextField,Container,Grid,Card,CardHeader,CardContent}from\"@material-ui/core\";import{motion}from\"framer-motion\";import CloseIcon from\"@material-ui/icons/Close\";import Axios from\"axios\";var SaleModal=function SaleModal(_ref){var setSaleOpen=_ref.setSaleOpen,stock=_ref.stock;return/*#__PURE__*/React.createElement(motion.div,{className:styles.backdrop,initial:{opacity:0},animate:{opacity:1},id:\"backdrop\"},/*#__PURE__*/React.createElement(Container,null,/*#__PURE__*/React.createElement(motion.div,{animate:{opacity:1,y:-20}},/*#__PURE__*/React.createElement(SaleModalContent,{setSaleOpen:setSaleOpen,stock:stock}))));};var SaleModalContent=function SaleModalContent(_ref2){var setSaleOpen=_ref2.setSaleOpen,stock=_ref2.stock;var _useContext=useContext(UserContext),info=_useContext.info;var _useState=useState(1),_useState2=_slicedToArray(_useState,2),quantity=_useState2[0],setQuantity=_useState2[1];var handleQuantityChange=function handleQuantityChange(e){if(!isNaN(e.target.value)&&Number(e.target.value)<=stock.quantity){setQuantity(e.target.value);}};var handleClick=function handleClick(){setSaleOpen(false);};var sellStock=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var headers,data,url,response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();headers={\"x-auth-token\":info.token};data={stockId:stock.id,quantity:Number(quantity),userId:info.user.id,price:Number(stock.currentPrice)};url=\"/api/stock\";_context.next=6;return Axios.patch(url,data,{headers:headers});case 6:response=_context.sent;if(response.data.status===\"success\"){window.location.reload();}case 8:case\"end\":return _context.stop();}}},_callee);}));return function sellStock(_x){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(Grid,{container:true,spacing:0,direction:\"column\",alignItems:\"center\",justify:\"center\",style:{minHeight:\"100vh\"}},/*#__PURE__*/React.createElement(Box,{width:\"60vh\",boxShadow:1},/*#__PURE__*/React.createElement(Card,null,/*#__PURE__*/React.createElement(CardHeader,{action:/*#__PURE__*/React.createElement(IconButton,{\"aria-label\":\"Close\",onClick:handleClick},/*#__PURE__*/React.createElement(CloseIcon,null))}),/*#__PURE__*/React.createElement(CardContent,null,/*#__PURE__*/React.createElement(Typography,{component:\"h1\",variant:\"h6\",align:\"center\"},\"Sell\"),/*#__PURE__*/React.createElement(\"form\",{className:styles.form,onSubmit:function onSubmit(e){return e.preventDefault();}},/*#__PURE__*/React.createElement(TextField,{variant:\"outlined\",margin:\"normal\",fullWidth:true,disabled:true,id:\"name\",label:\"Name\",name:\"Name\",autoComplete:\"Name\",value:stock.name}),/*#__PURE__*/React.createElement(TextField,{variant:\"outlined\",margin:\"normal\",fullWidth:true,disabled:true,id:\"price\",label:\"Price\",name:\"price\",autoComplete:\"price\",value:stock.currentPrice}),/*#__PURE__*/React.createElement(TextField,{variant:\"outlined\",margin:\"normal\",required:true,fullWidth:true,id:\"quantity\",label:\"Quantity\",name:\"quantity\",autoComplete:\"quantity\",value:quantity,onChange:handleQuantityChange})),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(Box,{display:\"flex\",justifyContent:\"center\"},/*#__PURE__*/React.createElement(Button,{type:\"submit\",variant:\"contained\",color:\"primary\",className:styles.confirm,onClick:sellStock},\"Confirm\")),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"br\",null)))));};export default SaleModal;","map":{"version":3,"sources":["/Users/linqiaosen/Desktop/domo/staging-demo-i/client/src/components/Dashboard/SaleModal.jsx"],"names":["React","useState","useContext","UserContext","styles","Typography","IconButton","Box","Button","TextField","Container","Grid","Card","CardHeader","CardContent","motion","CloseIcon","Axios","SaleModal","setSaleOpen","stock","backdrop","opacity","y","SaleModalContent","info","quantity","setQuantity","handleQuantityChange","e","isNaN","target","value","Number","handleClick","sellStock","preventDefault","headers","token","data","stockId","id","userId","user","price","currentPrice","url","patch","response","status","window","location","reload","minHeight","form","name","confirm"],"mappings":"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","sourcesContent":["import React, { useState, useContext } from \"react\";\r\nimport UserContext from \"../../context/UserContext\";\r\nimport styles from \"../Template/PageTemplate.module.css\";\r\nimport {\r\n  Typography,\r\n  IconButton,\r\n  Box,\r\n  Button,\r\n  TextField,\r\n  Container,\r\n  Grid,\r\n  Card,\r\n  CardHeader,\r\n  CardContent,\r\n} from \"@material-ui/core\";\r\nimport { motion } from \"framer-motion\";\r\nimport CloseIcon from \"@material-ui/icons/Close\";\r\nimport Axios from \"axios\";\r\n\r\nconst SaleModal = ({ setSaleOpen, stock }) => {\r\n  return (\r\n    <motion.div\r\n      className={styles.backdrop}\r\n      initial={{ opacity: 0 }}\r\n      animate={{ opacity: 1 }}\r\n      id=\"backdrop\"\r\n    >\r\n      <Container>\r\n        <motion.div animate={{ opacity: 1, y: -20 }}>\r\n          <SaleModalContent setSaleOpen={setSaleOpen} stock={stock} />\r\n        </motion.div>\r\n      </Container>\r\n    </motion.div>\r\n  );\r\n};\r\n\r\nconst SaleModalContent = ({ setSaleOpen, stock }) => {\r\n  const { info } = useContext(UserContext);\r\n  const [quantity, setQuantity] = useState(1);\r\n\r\n  const handleQuantityChange = (e) => {\r\n    if (!isNaN(e.target.value) && Number(e.target.value) <= stock.quantity) {\r\n      setQuantity(e.target.value);\r\n    }\r\n  };\r\n\r\n  const handleClick = () => {\r\n    setSaleOpen(false);\r\n  };\r\n\r\n  const sellStock = async (e) => {\r\n    e.preventDefault();\r\n\r\n    const headers = {\r\n      \"x-auth-token\": info.token,\r\n    };\r\n\r\n    const data = {\r\n      stockId: stock.id,\r\n      quantity: Number(quantity),\r\n      userId: info.user.id,\r\n      price: Number(stock.currentPrice),\r\n    };\r\n\r\n    const url = `/api/stock`;\r\n    const response = await Axios.patch(url, data, {\r\n      headers,\r\n    });\r\n\r\n    if (response.data.status === \"success\") {\r\n      window.location.reload();\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Grid\r\n      container\r\n      spacing={0}\r\n      direction=\"column\"\r\n      alignItems=\"center\"\r\n      justify=\"center\"\r\n      style={{ minHeight: \"100vh\" }}\r\n    >\r\n      <Box width=\"60vh\" boxShadow={1}>\r\n        <Card>\r\n          <CardHeader\r\n            action={\r\n              <IconButton aria-label=\"Close\" onClick={handleClick}>\r\n                <CloseIcon />\r\n              </IconButton>\r\n            }\r\n          />\r\n          <CardContent>\r\n            <Typography component=\"h1\" variant=\"h6\" align=\"center\">\r\n              Sell\r\n            </Typography>\r\n            <form className={styles.form} onSubmit={(e) => e.preventDefault()}>\r\n              <TextField\r\n                variant=\"outlined\"\r\n                margin=\"normal\"\r\n                fullWidth\r\n                disabled\r\n                id=\"name\"\r\n                label=\"Name\"\r\n                name=\"Name\"\r\n                autoComplete=\"Name\"\r\n                value={stock.name}\r\n              />\r\n              <TextField\r\n                variant=\"outlined\"\r\n                margin=\"normal\"\r\n                fullWidth\r\n                disabled\r\n                id=\"price\"\r\n                label=\"Price\"\r\n                name=\"price\"\r\n                autoComplete=\"price\"\r\n                value={stock.currentPrice}\r\n              />\r\n              <TextField\r\n                variant=\"outlined\"\r\n                margin=\"normal\"\r\n                required\r\n                fullWidth\r\n                id=\"quantity\"\r\n                label=\"Quantity\"\r\n                name=\"quantity\"\r\n                autoComplete=\"quantity\"\r\n                value={quantity}\r\n                onChange={handleQuantityChange}\r\n              />\r\n            </form>\r\n            <br />\r\n            <Box display=\"flex\" justifyContent=\"center\">\r\n              <Button\r\n                type=\"submit\"\r\n                variant=\"contained\"\r\n                color=\"primary\"\r\n                className={styles.confirm}\r\n                onClick={sellStock}\r\n              >\r\n                Confirm\r\n              </Button>\r\n            </Box>\r\n\r\n            <br />\r\n            <br />\r\n          </CardContent>\r\n        </Card>\r\n      </Box>\r\n    </Grid>\r\n  );\r\n};\r\n\r\nexport default SaleModal;\r\n"]},"metadata":{},"sourceType":"module"}